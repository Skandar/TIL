# Кэширование

- (HTTP) cache — кэш запроса и ответа. Используется для последующих запросов. Может быть shared или private.
- Private/local/browser cache — кэш браузера в котором хранится персонализированный контент для одного пользователя.
- Shared cache — кэш находящийся где-то между клиентом и сервером (в CDN или Proxy). Используется для хранения одного запроса/ответа и используется для нескольких пользователей, поэтому нужно избегать хранения там персонализированных запросов.

## Директивы

#### stale-while-revalidate

Директива используется в ответе.

Эта директива говорит браузеру, что если ответ **несвежий** и с момента как он протух не успело пройти указанное время, используй несвежий ответ, но в фоне сделай запрос за свежими данными. Таким образом при следующем запросе в кеше уже будет свежий ответ, который с кэша и возьмётся.

## Примеры

```txt
<!--
  1. Ответ протухнет через 604800 секунд после кэширования.
  2. После того как ответ протух в течении 86400 секунд на первый запрос
    будет возвращён протухший ответ и сделан фоновый запрос за новыми данными
-->
Cache-Control: max-age=604800, stale-while-revalidate=86400
```

## Поддержка

- [mdn](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control#browser_compatibility)

## Ссылки

- [mdn. Cache-Control](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control)
