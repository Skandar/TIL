# Ветки

`HEAD` - указатель на ветку и коммит в этой ветке. Показывает с каким коммитов происходит работа в данный момент.

## Список веток

Список веток можно получить используя команду `branch`.

```bash
git branch
```

Так же для того чтобы получить дополнительную информацию можно использовать параметр `-v`.

- `-v` (`--verbose`) - выводит список всех веток с информацией о последнем коммите (короткий хэш коммита (sha1) + сообщение коммита). Если параметр указан дважды (`-vv` или `--verbose --verbose`) выводит так же название удалённой ветки.

## Создание ветки

Для создания новой ветки нужно использовать команду `branch` и указать имя ветки.

```bash
git branch branch_name
```

## Переключение между ветками

Для переключения на другую ветку нужно использовать команду `checkout`.

```bash
git checkout branch_name
```

В git есть специальный параметр `-b`, который позволяет создать новую ветку и сразу на неё переключиться. Результат получается как после использования команд `git branch new_branch` + `git checkout new_branch`.

```bash
git checkout -b new_branch
```

Иногда возникают ситуации, когда нужно отменить все неиндексированные изменения в файлах, например, когда после проверки какой-то гипотезы, выяснилось, что она не верна и написанный код не нужен. Для этого можно выполнить команду `checkout` с параметром `-f`:

```bash
git checkout -f another_branch

# или

git checkout -f HEAD
```

## Переключение между ветками с незакоммиченными изменениями

При попытке переключиться между ветками с незакомиченными изменениями может возникнуть следующие ситуации:

- Если файлы в ветках отличаются, то операция прервётся с предупреждением.
- Если файлы в ветках, до внесения изменений, одинаковые, то переход выполнится вместе с изменениями. Это может привести к тому, что изменения выполненные для одной ветки могут быть случайно применены к другой ветке (в которую выполнен переход).

Для сохранения изменений при переключении на другую ветку нужно выполнить команду `stash`, которая сохраняет все изменения в текущей ветке.

```bash
git stash
```

Когда нужно восстановить сохранённые изменения нужно вызвать команду `stash pop`

```bash
git stash pop
```

Нужно помнить, что сохранённые изменения не привязаны к какой-либо ветке, и могут быть применены к любой из веток.

## Передвижение веток

Иногда может понадобится создать ветку от какого-то коммита или передвинуть ветку к какому-то коммиту. Передвинуть текущую ветку нельзя, для этого нужно сначала перейти на другую ветку.

```bash
# Создаёт новую ветку от указанного коммита
git branch branch_name a12df1

# Если ветка с таким именем существует, то git прервёт операцию и выдаст предупреждение.
# Принудительно создать ветку можно с помощью параметра -f
git branch -f branch_name a12df1

# Так можно создать ветку и сразу на неё перейти.
# Если ветка с таким именем уже есть, git её принудительно передвинет.
git checkout -B branch_name a12df1

# Переместит ветку branch_name к последнему коммиту в ветке another_branch_name
git branch -f branch_name another_branch_name
```

Это может быть полезным, когда мы закоммитили какие-то изменения, и позже решили создать новую ветку с этими коммитами, а текущую ветку откатить, до состояние, когда этих коммитов в ней ещё не было.

## Слияние веток

Для слияния веток в git есть команда `merge`. Она сливает указанную ветку в текущую.

```bash
git merge branch_name
```

## Удаление ветки

Удалить ненужную ветку можно с помощью с помощью команды `branch` с параметром `-d`.

```bash
git branch -d branch_name
```

Однако, если ветка, которую необходимо удалить, не слита с какой-то другой веткой, то git выдаст предупреждение и прервёт операцию. Это позволяет исключить случайные удаления.

Если ветка точно не нужна и не планируется её сливать с какой-то другой веткой, то можно её удалить в принудительном порядке, для этого нужно использовать параметр `-D`.

```bash
git branch -d branch_name
```

После удаления ветки, по сути происходит удаление указателя на последний коммит ветки, а сами коммиты ещё какое-то время существуют, пока сборщик мусора git их не удалит.

Таким образом удалённую ветку можно восстановить. Нужно создать новую ветку с указанием последнего коммита удалённой ветки.

```bash
git branch branch_name a12df1
```

## Ссылки

- [4.1 - 4.11 Скринкаст по Git – Ветки](https://www.youtube.com/watch?v=A9C7lJMaf1M&list=PLDyvV36pndZHkDRik6kKF6gSb0N0W995h&index=20)
- [Git Docs. git-branch](https://git-scm.com/docs/git-branch)
